#!/usr/bin/awk -f

END{while(S(">",++N)+S("v"));print N}function S(t,e,p){for(k in A)
B[k]=A[k];for(k in B)p+=B[$0=k]~t&&0~B[i=(k+!e)%NR" "($2+!!e)%W]&&
A[i]=(A[k]=0)t;return p}{for(W=i=gsub(z,FS)-1;i;)A[NR-1" "--i]=$i}
