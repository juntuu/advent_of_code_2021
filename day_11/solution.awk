#!/usr/bin/awk -f

function I(n,c){(k=y+n"\34"x+c)in G&&G[k]&&++G[k]}END{
for(;n-NR*w;++B<101&&A+=n){for(k in G)n=!++G[k];do{f=0
for(y=0;y++<NR;)for(x=0;x++<w;)G[y,x]>9&&G[y,x]=I(I(1,
1),1)I(f=-1,f)I(1)I(f)I(f,1)I(!++n,f)I(1,f)}while(-f)}
print A"\n"B}{for(w=i=split($0,a,z);i;)G[NR,i--]=a[i]}
